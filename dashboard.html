<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Quick - Project Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #4ecdc4;
        }

        .user-menu {
            position: relative;
            display: inline-block;
        }

        .user-button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 1rem;
            min-width: 200px;
            display: none;
            z-index: 1001;
        }

        .user-dropdown.active {
            display: block;
        }

        .user-dropdown a {
            display: block;
            padding: 8px 0;
            color: white;
            text-decoration: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-dropdown a:last-child {
            border-bottom: none;
        }

        .user-dropdown a:hover {
            color: #4ecdc4;
        }

        .subscription-info {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 0.5rem;
        }

        .subscription-status {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .plan-name {
            font-weight: bold;
            color: #4ecdc4;
        }

        .video-count {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .guest-banner {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .banner-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .banner-icon {
            font-size: 2rem;
        }

        .banner-text h3 {
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .banner-text p {
            margin: 0;
            opacity: 0.9;
        }

        .banner-link {
            color: white;
            text-decoration: underline;
            font-weight: bold;
        }

        .banner-link:hover {
            opacity: 0.8;
        }

        /* Dashboard Layout */
        .dashboard {
            padding: 120px 0 80px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .dashboard-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #4ecdc4;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Projects Grid */
        .projects-section {
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
        }

        .project-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            transition: transform 0.3s;
        }

        .project-card:hover {
            transform: translateY(-5px);
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .project-name {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .project-status {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-uploaded { background: rgba(255, 193, 7, 0.2); color: #ffc107; }
        .status-processing { background: rgba(13, 110, 253, 0.2); color: #0d6efd; }
        .status-completed { background: rgba(25, 135, 84, 0.2); color: #198754; }
        .status-error { background: rgba(220, 53, 69, 0.2); color: #dc3545; }

        .project-details {
            margin-bottom: 1rem;
        }

        .project-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .project-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-danger {
            background: rgba(220, 53, 69, 0.8);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Progress Bar */
        .progress-container {
            margin: 1rem 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4ecdc4, #ff6b6b);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

                 .progress-text {
             text-align: center;
             font-size: 0.8rem;
             margin-top: 0.5rem;
             opacity: 0.8;
         }
         
         .progress-step {
             text-align: center;
             font-size: 0.75rem;
             margin-top: 0.25rem;
             opacity: 0.7;
             font-style: italic;
         }

        /* Upload Section */
        .upload-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 3rem;
            backdrop-filter: blur(10px);
        }

        .upload-area {
            border: 3px dashed #4ecdc4;
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            margin: 1rem 0;
            transition: all 0.3s;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .upload-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-group select,
        .form-group input {
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }

        .upload-btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1rem;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        /* Loading States */
        .loading {
            text-align: center;
            padding: 2rem;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #4ecdc4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-title {
                font-size: 2rem;
            }
            
            .projects-grid {
                grid-template-columns: 1fr;
            }
            
            .upload-form {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Style Details Panel */
        .style-details {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .style-details h4 {
            margin-bottom: 1rem;
            color: #4ecdc4;
        }

        .style-description {
            font-size: 0.9rem;
            color: #e0e0e0;
            margin-bottom: 0.5rem;
        }

        .style-features {
            font-size: 0.8rem;
            color: #b0b0b0;
            list-style: none;
            padding: 0;
        }

        .style-features li {
            margin-bottom: 0.25rem;
        }

        /* Advanced Options */
        .advanced-options {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .advanced-options h4 {
            margin-bottom: 1rem;
            color: #4ecdc4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .option-group label {
            font-weight: bold;
            color: #e0e0e0;
        }

        .option-group input[type="file"],
        .option-group select {
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.9rem;
        }

        .option-group input[type="file"]::file-selector-button {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-group input[type="file"]::file-selector-button:hover {
            background: linear-gradient(45deg, #4ecdc4, #ff6b6b);
        }

        .option-group select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12' fill='none' stroke='%23e0e0e0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='lucide lucide-chevron-down'%3E%3Cpath d='m3 5 3 3 3-3'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 1rem;
            padding-right: 2.5rem;
        }

        .option-group small {
            font-size: 0.8rem;
            color: #b0b0b0;
            margin-top: 0.5rem;
        }

        /* AI Insights */
        .ai-insights {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .ai-insights h5 {
            margin-bottom: 0.75rem;
            color: #4ecdc4;
        }

        .insights-content {
            font-size: 0.9rem;
            color: #e0e0e0;
            line-height: 1.5;
        }

        /* AI Analytics */
        .ai-analytics {
            margin-top: 3rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .analytics-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .analytics-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #4ecdc4;
        }

        .analytics-content h4 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #e0e0e0;
        }

        .analytics-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4ecdc4;
            margin-bottom: 0.5rem;
        }

        .analytics-card small {
            font-size: 0.8rem;
            color: #b0b0b0;
        }

        /* New styles for multiple video upload */
        .upload-hint {
            font-size: 0.9rem;
            color: #e0e0e0;
            margin-top: 0.5rem;
        }

        .selected-videos {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .selected-videos h4 {
            margin-bottom: 1rem;
            color: #4ecdc4;
        }

        .video-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .video-list .video-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            color: #e0e0e0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .video-list .video-item .remove-video {
            color: #ff6b6b;
            cursor: pointer;
            font-size: 1rem;
        }

        .ai-customization {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-customization h4 {
            margin-bottom: 1rem;
            color: #4ecdc4;
        }

        .customization-box {
            position: relative;
        }

        .customization-box textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.9rem;
            resize: vertical;
            min-height: 100px;
        }

        .customization-box textarea:focus {
            outline: none;
            border-color: #4ecdc4;
        }

        .customization-tips {
            position: absolute;
            bottom: -1.5rem; /* Adjust as needed */
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
            padding: 0.5rem 1rem;
            font-size: 0.7rem;
            color: #e0e0e0;
            text-align: right;
        }

        .ai-instructions-preview {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            color: #4ecdc4;
            font-style: italic;
        }

        .video-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            font-size: 0.85rem;
            color: #e0e0e0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.3s;
        }

        .video-item:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .video-item .remove-video {
            color: #ff6b6b;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 0.25rem;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .video-item .remove-video:hover {
            background: rgba(255, 107, 107, 0.2);
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="container">
            <div class="logo">Edit Quick</div>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="#dashboard">Dashboard</a>
                <a href="#upload">Upload</a>
                <a href="#shared">Shared</a>
                <a href="#analytics">Analytics</a>
            </div>
            <div class="user-menu">
                <button class="user-button" onclick="toggleUserMenu()">
                    <span id="username">Guest</span>
                    <span>‚ñº</span>
                </button>
                <div class="user-dropdown" id="userDropdown">
                    <div class="subscription-info" id="subscriptionInfo" style="display: none;">
                        <div class="subscription-status">
                            <span class="plan-name" id="planName">Basic Plan</span>
                            <span class="video-count" id="videoCount">5/10 videos</span>
                        </div>
                    </div>
                    <a href="#profile">Profile</a>
                    <a href="#settings">Settings</a>
                    <a href="/plans" id="subscriptionLink">Subscription</a>
                    <a href="#" onclick="logout()">Logout</a>
                </div>
            </div>
        </nav>
    </header>

    <!-- Dashboard -->
    <section class="dashboard fade-in">
        <div class="container">
            <div class="dashboard-header">
                <h1 class="dashboard-title">Your AI Video Projects</h1>
                <p>Track your AI-powered video editing projects and create new ones</p>
            </div>

            <!-- Guest Usage Banner -->
            <div class="guest-banner" id="guestBanner" style="display: none;">
                <div class="banner-content">
                    <div class="banner-icon">üé¨</div>
                    <div class="banner-text">
                        <h3>Free Trial Status</h3>
                        <p>You have <span id="remainingVideos">1</span> free video edit(s) remaining. <a href="/plans" class="banner-link">View Plans</a></p>
                    </div>
                </div>
            </div>

            <!-- Stats -->
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalProjects">0</div>
                    <div class="stat-label">Total Projects</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completedProjects">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="processingProjects">0</div>
                    <div class="stat-label">Processing</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalVideos">0</div>
                    <div class="stat-label">Videos Created</div>
                </div>
            </div>

            <!-- AI Analytics -->
            <div class="ai-analytics">
                <h3 class="section-title">ü§ñ AI Performance Analytics</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-icon">‚ö°</div>
                        <div class="analytics-content">
                            <h4>Processing Speed</h4>
                            <div class="analytics-value" id="avgProcessingTime">0 min</div>
                            <small>Average time per video</small>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-icon">üéØ</div>
                        <div class="analytics-content">
                            <h4>AI Accuracy</h4>
                            <div class="analytics-value" id="aiAccuracy">95%</div>
                            <small>Event detection rate</small>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-icon">üöÄ</div>
                        <div class="analytics-content">
                            <h4>Style Popularity</h4>
                            <div class="analytics-value" id="popularStyle">Gaming</div>
                            <small>Most used style</small>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-icon">üíæ</div>
                        <div class="analytics-content">
                            <h4>Storage Used</h4>
                            <div class="analytics-value" id="storageUsed">0 GB</div>
                            <small>Of 100 GB available</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <section id="upload" class="upload-section fade-in">
                <h2 class="section-title">Create New AI Video</h2>
                
                <!-- Multiple Video Upload Area -->
                <div class="upload-area" onclick="document.getElementById('videoInput').click()">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Upload Your Videos</h3>
                    <p>Click here to select multiple video files or drag and drop</p>
                    <p class="upload-hint">üé¨ You can upload multiple videos to combine them into one!</p>
                    <input type="file" id="videoInput" accept="video/*" multiple style="display: none;" onchange="handleVideoSelect(event)">
                </div>

                <!-- Selected Videos Preview -->
                <div id="selectedVideos" class="selected-videos" style="display: none;">
                    <h4>üìπ Selected Videos</h4>
                    <div id="videoList" class="video-list"></div>
                    <button class="btn btn-secondary" onclick="clearSelectedVideos()">üóëÔ∏è Clear All</button>
                </div>

                <!-- AI Text Customization Box -->
                <div class="ai-customization">
                    <h4>ü§ñ AI Custom Instructions</h4>
                    <div class="customization-box">
                        <textarea 
                            id="aiInstructions" 
                            placeholder="Describe exactly how you want your video edited! For example:&#10;&#10;üé¨ 'Make it cinematic with dramatic music, slow motion on action scenes, and add epic text overlays'&#10;&#10;üéµ 'Sync cuts to the beat, add glitch effects, and make it feel like a gaming montage'&#10;&#10;üí° 'Keep it professional, add smooth transitions, and highlight the key moments'&#10;&#10;‚ú® Be as specific as you want - the AI will follow your instructions!'
                            rows="6"
                        ></textarea>
                        <div class="customization-tips">
                            <small>üí° <strong>Pro Tips:</strong></small>
                            <small>‚Ä¢ Describe the mood, pacing, and effects you want</small>
                            <small>‚Ä¢ Mention specific music style or transitions</small>
                            <small>‚Ä¢ Include timing preferences (fast cuts, slow motion, etc.)</small>
                        </div>
                    </div>
                </div>

                <form id="uploadForm" class="upload-form">
                    <div class="form-group">
                        <label for="projectName">Project Name</label>
                        <input type="text" id="projectName" placeholder="My Awesome Video" required>
                    </div>
                    <div class="form-group">
                        <label for="styleSelect">Editing Style</label>
                        <select id="styleSelect" required onchange="updateStyleDetails()">
                            <option value="">Select a style category...</option>
                            <optgroup label="üéÆ Gaming & Entertainment">
                                <option value="gaming-montage">üéÆ Gaming Montage (Fast cuts, glitches)</option>
                                <option value="gaming-highlights">üî• Gaming Highlights (Kill streaks, epic moments)</option>
                                <option value="streamer-clips">üì∫ Streamer Clips (Reaction moments, funny fails)</option>
                            </optgroup>
                            <optgroup label="üèÄ Sports & Action">
                                <option value="sports-mixtape">üèÄ Sports Mixtape (Dunks, goals, highlights)</option>
                                <option value="action-sports">üèÇ Action Sports (Skateboarding, surfing, extreme)</option>
                                <option value="fitness-motivation">üí™ Fitness Motivation (Workout highlights, transformations)</option>
                            </optgroup>
                            <optgroup label="üé∂ Music & Performance">
                                <option value="music-video">üéµ Music Video (Beat-synced, cinematic)</option>
                                <option value="dance-performance">üíÉ Dance Performance (Rhythm-based cuts)</option>
                                <option value="live-concert">üé§ Live Concert (Crowd energy, stage presence)</option>
                            </optgroup>
                            <optgroup label="üì± Social Media">
                                <option value="tiktok-reels">üì± TikTok/Reels (9:16, trending effects)</option>
                                <option value="instagram-story">üì∏ Instagram Story (15s, vertical format)</option>
                                <option value="youtube-shorts">üé¨ YouTube Shorts (60s, engaging hooks)</option>
                            </optgroup>
                            <optgroup label="üé• Cinematic & Film">
                                <option value="cinematic-trailer">üé≠ Cinematic Trailer (Epic, dramatic)</option>
                                <option value="documentary">üåç Documentary (Narrative, educational)</option>
                                <option value="short-film">üé¨ Short Film (Artistic, storytelling)</option>
                            </optgroup>
                            <optgroup label="üè¢ Business & Professional">
                                <option value="corporate-presentation">üíº Corporate Presentation (Clean, professional)</option>
                                <option value="product-demo">üì± Product Demo (Clear, informative)</option>
                                <option value="marketing-ad">üì¢ Marketing Ad (Engaging, conversion-focused)</option>
                            </optgroup>
                            <optgroup label="üéì Education & Tutorials">
                                <option value="tutorial">üìö Tutorial (Step-by-step, clear)</option>
                                <option value="educational-content">üéì Educational Content (Engaging, informative)</option>
                                <option value="how-to-guide">üîß How-To Guide (Practical, actionable)</option>
                            </optgroup>
                            <optgroup label="üíç Lifestyle & Events">
                                <option value="wedding-video">üíí Wedding Video (Romantic, emotional)</option>
                                <option value="travel-vlog">‚úàÔ∏è Travel Vlog (Adventure, beautiful locations)</option>
                                <option value="event-coverage">üéâ Event Coverage (Parties, celebrations)</option>
                            </optgroup>
                            <optgroup label="üòÇ Comedy & Entertainment">
                                <option value="comedy-sketch">üòÇ Comedy Sketch (Timing, punchlines)</option>
                                <option value="meme-compilation">üé≠ Meme Compilation (Trending, viral)</option>
                                <option value="reaction-video">üò± Reaction Video (Emotional, engaging)</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <!-- Style Details Panel -->
                    <div id="styleDetails" class="style-details" style="display: none;">
                        <h4>üé® Style Preview</h4>
                        <div id="styleDescription" class="style-description"></div>
                        <div id="styleFeatures" class="style-features"></div>
                        
                        <!-- AI Insights Panel -->
                        <div class="ai-insights">
                            <h5>üß† AI Editing Insights</h5>
                            <div id="aiInsights" class="insights-content"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="intensitySelect">AI Intensity</label>
                        <select id="intensitySelect" required>
                            <option value="light">‚ú® Light (Subtle edits)</option>
                            <option value="medium">‚ö° Medium (Balanced)</option>
                            <option value="high">üöÄ High (Creative transformation)</option>
                            <option value="extreme">üí• Extreme (MrBeast level!)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="qualitySelect">Output Quality</label>
                        <select id="qualitySelect" required>
                            <option value="720p">üì∫ 720p (Fast)</option>
                            <option value="1080p">üé¨ 1080p (Standard)</option>
                            <option value="4k">üé≠ 4K (Premium)</option>
                            <option value="8k">üåü 8K (Ultra Premium)</option>
                        </select>
                    </div>
                </form>

                <!-- Advanced AI Options -->
                <div class="advanced-options">
                    <h4>üéõÔ∏è Advanced AI Options</h4>
                    <div class="options-grid">
                        <div class="option-group">
                            <label for="musicUpload">üéµ Background Music (Optional)</label>
                            <input type="file" id="musicUpload" accept="audio/*" onchange="handleMusicSelect(event)">
                            <small>AI will sync video cuts with music beats</small>
                        </div>
                        
                        <div class="option-group">
                            <label for="customEffects">‚ú® Custom Effects</label>
                            <select id="customEffects" multiple>
                                <option value="auto-captions">üìù Auto-Generated Captions</option>
                                <option value="brand-overlay">üè∑Ô∏è Brand Logo Overlay</option>
                                <option value="color-grading">üé® Advanced Color Grading</option>
                                <option value="motion-graphics">üé¨ Motion Graphics</option>
                                <option value="audio-enhancement">üîä Audio Enhancement</option>
                                <option value="stabilization">üìπ Video Stabilization</option>
                            </select>
                            <small>Hold Ctrl/Cmd to select multiple</small>
                        </div>
                        
                        <div class="option-group">
                            <label for="platformOptimize">üì± Platform Optimization</label>
                            <select id="platformOptimize">
                                <option value="auto">ü§ñ Auto-Detect (Recommended)</option>
                                <option value="youtube">üì∫ YouTube (16:9, 1080p)</option>
                                <option value="tiktok">üì± TikTok (9:16, 60s max)</option>
                                <option value="instagram">üì∏ Instagram (1:1, 15s story)</option>
                                <option value="twitter">üê¶ Twitter (16:9, 2:20 max)</option>
                                <option value="linkedin">üíº LinkedIn (16:9, professional)</option>
                            </select>
                            <small>Optimizes format and settings for your platform</small>
                        </div>
                        
                        <div class="option-group">
                            <label for="aiIntelligence">üß† AI Intelligence Level</label>
                            <select id="aiIntelligence">
                                <option value="smart">üß† Smart (Balanced creativity & speed)</option>
                                <option value="creative">üé® Creative (Maximum artistic freedom)</option>
                                <option value="conservative">‚öñÔ∏è Conservative (Subtle, professional)</option>
                                <option value="experimental">üöÄ Experimental (Cutting-edge effects)</option>
                            </select>
                            <small>Controls how creative the AI gets with your content</small>
                        </div>
                    </div>
                </div>

                <button class="upload-btn" onclick="uploadVideo()" id="uploadBtn">üöÄ Start AI Processing</button>
            </section>

            <!-- Projects Section -->
            <section id="dashboard" class="projects-section fade-in">
                <h2 class="section-title">Your Projects</h2>
                <div id="projectsGrid" class="projects-grid">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading your projects...</p>
                    </div>
                </div>
            </section>
        </div>
    </section>

    <script>
        const API_BASE = 'http://localhost:8080/api';
        let projects = [];

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadProjects();
            updateStats();
        });

        // Load projects from API
        async function loadProjects() {
            try {
                const headers = {};
                if (isAuthenticated()) {
                    headers['Authorization'] = `Bearer ${getAuthToken()}`;
                }

                const response = await fetch(`${API_BASE}/projects`, { headers });
                if (response.ok) {
                    projects = await response.json();
                    renderProjects();
                    updateStats();
                } else {
                    throw new Error('Failed to load projects');
                }
            } catch (error) {
                console.error('Error loading projects:', error);
                document.getElementById('projectsGrid').innerHTML = `
                    <div class="project-card">
                        <h3>Error Loading Projects</h3>
                        <p>Please make sure the backend server is running.</p>
                    </div>
                `;
            }
        }

        // Render projects in the grid
        function renderProjects() {
            const grid = document.getElementById('projectsGrid');
            
            if (projects.length === 0) {
                grid.innerHTML = `
                    <div class="project-card">
                        <h3>No Projects Yet</h3>
                        <p>Upload your first video to get started with AI editing!</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = projects.map(project => `
                <div class="project-card">
                    <div class="project-header">
                        <div class="project-name">${project.name}</div>
                        <div class="project-status status-${project.status}">${getStatusText(project.status)}</div>
                    </div>
                                         <div class="project-details">
                         <div class="project-detail">
                             <span>Style:</span>
                             <span>${getStyleDisplayName(project.style)}</span>
                         </div>
                         <div class="project-detail">
                             <span>Created:</span>
                             <span>${new Date(project.createdAt).toLocaleDateString()}</span>
                         </div>
                         <div class="project-detail">
                             <span>Videos:</span>
                             <span>${project.videoCount || 1} clip${project.videoCount > 1 ? 's' : ''}</span>
                         </div>
                         ${project.aiInstructions ? `
                             <div class="project-detail">
                                 <span>AI Instructions:</span>
                                 <span class="ai-instructions-preview">${project.aiInstructions.substring(0, 50)}${project.aiInstructions.length > 50 ? '...' : ''}</span>
                             </div>
                         ` : ''}
                         ${project.status === 'processing' ? `
                             <div class="progress-container">
                                 <div class="progress-bar">
                                     <div class="progress-fill" style="width: ${project.progress || 0}%"></div>
                                 </div>
                                 <div class="progress-text">${project.progress || 0}% Complete</div>
                                 ${project.currentStep ? `<div class="progress-step">${project.currentStep}</div>` : ''}
                             </div>
                         ` : ''}
                     </div>
                    <div class="project-actions">
                        ${getProjectActions(project)}
                    </div>
                </div>
            `).join('');
        }

        // Get status display text
        function getStatusText(status) {
            const statusMap = {
                'uploaded': 'Uploaded',
                'processing': 'Processing',
                'completed': 'Completed',
                'error': 'Error'
            };
            return statusMap[status] || status;
        }

        // Get style display name
        function getStyleDisplayName(style) {
            const styleMap = {
                'cinematic': 'üé¨ Cinematic',
                'mrbeast': 'üî• MrBeast',
                'vlog': 'üìπ Vlog',
                'podcast': 'üéôÔ∏è Podcast',
                'tutorial': 'üìö Tutorial',
                'motivational': 'üí™ Motivational',
                'surprise': 'üéâ Surprise',
                'meme': 'üòÇ Meme',
                'breaking': 'üö® Breaking News',
                'news': 'üì∞ News',
                'documentary': 'üé≠ Documentary',
                'videogame': 'üéÆ Gaming',
                'social': 'üì± Social Media',
                'corporate': 'üíº Corporate',
                'music': 'üéµ Music Video',
                'highlights': 'üî• Epic Highlights',
                'dramatic': 'üé≠ Dramatic Moments',
                'energetic': '‚ö° High Energy',
                'professional': 'üèÜ Professional'
            };
            return styleMap[style] || style;
        }

        // Get sport display name
        function getSportDisplayName(sport) {
            const sportMap = {
                'basketball': 'üèÄ Basketball',
                'football': '‚öΩ Football/Soccer',
                'american-football': 'üèà American Football',
                'baseball': '‚öæ Baseball',
                'tennis': 'üéæ Tennis',
                'volleyball': 'üèê Volleyball',
                'hockey': 'üèí Hockey',
                'golf': '‚õ≥ Golf',
                'swimming': 'üèä Swimming',
                'track': 'üèÉ Track & Field',
                'mixed': 'üéØ Mixed Sports'
            };
            return sportMap[sport] || sport;
        }

        // Get project action buttons
        function getProjectActions(project) {
            let actions = [];
            
            if (project.status === 'uploaded') {
                actions.push(`<button class="btn btn-primary" onclick="startProcessing('${project.id}')">üöÄ Start AI Processing</button>`);
            }
            
            if (project.status === 'processing') {
                actions.push(`<button class="btn btn-secondary" disabled>‚è≥ AI Processing...</button>`);
            }
            
            if (project.status === 'completed') {
                actions.push(`<button class="btn btn-secondary" onclick="previewVideo('${project.id}')">üëÅÔ∏è Preview</button>`);
                actions.push(`<button class="btn btn-primary" onclick="downloadVideo('${project.id}')">üì• Download</button>`);
            }
            
            if (project.status === 'error') {
                actions.push(`<button class="btn btn-danger" onclick="retryProcessing('${project.id}')">üîÑ Retry</button>`);
            }
            
            actions.push(`<button class="btn btn-danger" onclick="deleteProject('${project.id}')">üóëÔ∏è Delete</button>`);
            
            return actions.join('');
        }

        // Update dashboard stats
        function updateStats() {
            const total = projects.length;
            const completed = projects.filter(p => p.status === 'completed').length;
            const processing = projects.filter(p => p.status === 'processing').length;
            const videos = completed;

            document.getElementById('totalProjects').textContent = total;
            document.getElementById('completedProjects').textContent = completed;
            document.getElementById('processingProjects').textContent = processing;
            document.getElementById('totalVideos').textContent = videos;

            // Update AI analytics
            updateAnalytics();
        }

        // Update AI analytics
        function updateAnalytics() {
            const completedProjects = projects.filter(p => p.status === 'completed');
            
            // Calculate average processing time (simulated)
            const avgTime = completedProjects.length > 0 ? Math.floor(Math.random() * 3) + 2 : 0;
            document.getElementById('avgProcessingTime').textContent = `${avgTime} min`;
            
            // AI accuracy (simulated, but realistic)
            const accuracy = Math.floor(Math.random() * 5) + 92; // 92-97%
            document.getElementById('aiAccuracy').textContent = `${accuracy}%`;
            
            // Most popular style
            if (projects.length > 0) {
                const styleCounts = {};
                projects.forEach(p => {
                    styleCounts[p.style] = (styleCounts[p.style] || 0) + 1;
                });
                const popularStyle = Object.keys(styleCounts).reduce((a, b) => 
                    styleCounts[a] > styleCounts[b] ? a : b
                );
                const styleNames = {
                    'gaming-montage': 'Gaming',
                    'sports-mixtape': 'Sports',
                    'music-video': 'Music',
                    'tiktok-reels': 'TikTok',
                    'cinematic-trailer': 'Cinematic',
                    'corporate-presentation': 'Corporate',
                    'tutorial': 'Tutorial',
                    'travel-vlog': 'Travel',
                    'wedding-video': 'Wedding',
                    'comedy-sketch': 'Comedy'
                };
                document.getElementById('popularStyle').textContent = styleNames[popularStyle] || 'Mixed';
            }
            
            // Storage usage (simulated)
            const totalSize = projects.reduce((sum, p) => sum + (p.fileSize || 0), 0);
            const storageGB = (totalSize / (1024 * 1024 * 1024)).toFixed(1);
            document.getElementById('storageUsed').textContent = `${storageGB} GB`;
        }

        // Handle video file selection
        function handleVideoSelect(event) {
            const files = event.target.files;
            const uploadArea = document.querySelector('.upload-area');
            const videoList = document.getElementById('videoList');
            const selectedVideosDiv = document.getElementById('selectedVideos');

            if (files.length === 0) {
                uploadArea.innerHTML = `
                    <div class="upload-icon">üìÅ</div>
                    <h3>Upload Your Videos</h3>
                    <p>Click here to select multiple video files or drag and drop</p>
                    <p class="upload-hint">üé¨ You can upload multiple videos to combine them into one!</p>
                    <input type="file" id="videoInput" accept="video/*" multiple style="display: none;" onchange="handleVideoSelect(event)">
                `;
                uploadArea.onclick = () => document.getElementById('videoInput').click();
                videoList.innerHTML = ''; // Clear previous list
                selectedVideosDiv.style.display = 'none';
                return;
            }

            uploadArea.innerHTML = `
                <div class="upload-icon">‚úÖ</div>
                <h3>File Selected!</h3>
                <p>Click to change file</p>
            `;
            uploadArea.onclick = () => document.getElementById('videoInput').click();

            videoList.innerHTML = '';
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                videoList.innerHTML += `
                    <div class="video-item">
                        ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)
                        <span class="remove-video" onclick="removeSelectedVideo(this)">‚úï</span>
                    </div>
                `;
            }
            selectedVideosDiv.style.display = 'block';
        }

        // Remove selected video from the list
        function removeSelectedVideo(button) {
            const videoItem = button.parentElement;
            videoItem.remove();
            if (document.getElementById('videoInput').files.length === 0) {
                document.querySelector('.upload-area').innerHTML = `
                    <div class="upload-icon">üìÅ</div>
                    <h3>Upload Your Videos</h3>
                    <p>Click here to select multiple video files or drag and drop</p>
                    <p class="upload-hint">üé¨ You can upload multiple videos to combine them into one!</p>
                    <input type="file" id="videoInput" accept="video/*" multiple style="display: none;" onchange="handleVideoSelect(event)">
                `;
                document.querySelector('.upload-area').onclick = () => document.getElementById('videoInput').click();
            }
        }

        // Clear all selected videos
        function clearSelectedVideos() {
            document.getElementById('videoInput').value = ''; // Clear file input
            document.querySelector('.upload-area').innerHTML = `
                <div class="upload-icon">üìÅ</div>
                <h3>Upload Your Videos</h3>
                <p>Click here to select multiple video files or drag and drop</p>
                <p class="upload-hint">üé¨ You can upload multiple videos to combine them into one!</p>
                <input type="file" id="videoInput" accept="video/*" multiple style="display: none;" onchange="handleVideoSelect(event)">
            `;
            document.querySelector('.upload-area').onclick = () => document.getElementById('videoInput').click();
            document.getElementById('videoList').innerHTML = '';
            document.getElementById('selectedVideos').style.display = 'none';
        }

        // Handle music file selection
        function handleMusicSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const musicUploadGroup = document.getElementById('musicUpload').parentElement;
                musicUploadGroup.innerHTML = `
                    <div class="upload-icon">‚úÖ</div>
                    <h3>Music Selected!</h3>
                    <p>${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)</p>
                    <small>Click to change music</small>
                `;
                musicUploadGroup.onclick = () => document.getElementById('musicUpload').click();
            }
        }

        // Update style details panel
        function updateStyleDetails() {
            const styleSelect = document.getElementById('styleSelect');
            const styleDetails = document.getElementById('styleDetails');
            const styleDescription = document.getElementById('styleDescription');
            const styleFeatures = document.getElementById('styleFeatures');
            const aiInsights = document.getElementById('aiInsights');

            const selectedStyle = styleSelect.value;
            styleDetails.style.display = selectedStyle ? 'block' : 'none';

            if (selectedStyle) {
                const styleInfo = getStyleInfo(selectedStyle);
                styleDescription.textContent = styleInfo.description;
                styleFeatures.innerHTML = styleInfo.features.map(feature => `<li>${feature}</li>`).join('');

                // Get AI insights for the selected style
                const insights = getAIInsights(selectedStyle);
                aiInsights.innerHTML = insights.map(insight => `<p>${insight}</p>`).join('');
            } else {
                styleDescription.textContent = '';
                styleFeatures.innerHTML = '';
                aiInsights.innerHTML = ''; // Clear insights if no style is selected
            }
        }

        // Get style information
        function getStyleInfo(style) {
            const styles = {
                'gaming-montage': {
                    description: 'Creates a fast-paced, glitchy, and energetic montage from gaming footage.',
                    features: ['Fast cuts', 'Glitches', 'Color grading', 'Dynamic transitions']
                },
                'gaming-highlights': {
                    description: 'Highlights the most exciting and impactful moments from gaming footage.',
                    features: ['Kill streaks', 'Epic moments', 'Color grading', 'Dynamic transitions']
                },
                'streamer-clips': {
                    description: 'Captures funny, reaction, and fail moments from streamers.',
                    features: ['Reaction moments', 'Funny fails', 'Color grading', 'Dynamic transitions']
                },
                'sports-mixtape': {
                    description: 'Combines multiple sports moments into a cohesive, highlight-packed video.',
                    features: ['Dunks', 'Goals', 'Highlights', 'Color grading', 'Dynamic transitions']
                },
                'action-sports': {
                    description: 'Edits action sports footage (skateboarding, surfing, extreme sports) for a thrilling experience.',
                    features: ['Skateboarding', 'Surfing', 'Extreme sports', 'Color grading', 'Dynamic transitions']
                },
                'fitness-motivation': {
                    description: 'Edits workout footage to create motivational and inspiring content.',
                    features: ['Workout highlights', 'Transformations', 'Color grading', 'Dynamic transitions']
                },
                'music-video': {
                    description: 'Creates a cinematic music video with beat-synced cuts and dynamic transitions.',
                    features: ['Beat-synced cuts', 'Cinematic', 'Color grading', 'Dynamic transitions']
                },
                'dance-performance': {
                    description: 'Edits dance performance footage for a rhythm-based, energetic video.',
                    features: ['Rhythm-based cuts', 'Energy', 'Color grading', 'Dynamic transitions']
                },
                'live-concert': {
                    description: 'Edits live concert footage to capture the energy and excitement of the audience.',
                    features: ['Crowd energy', 'Stage presence', 'Color grading', 'Dynamic transitions']
                },
                'tiktok-reels': {
                    description: 'Creates a TikTok/Reels style video with 9:16 format and trending effects.',
                    features: ['9:16 format', 'Trending effects', 'Color grading', 'Dynamic transitions']
                },
                'instagram-story': {
                    description: 'Edits footage for Instagram Story with 15s vertical format and engaging hooks.',
                    features: ['15s vertical format', 'Engaging hooks', 'Color grading', 'Dynamic transitions']
                },
                'youtube-shorts': {
                    description: 'Edits footage for YouTube Shorts with 60s length and engaging hooks.',
                    features: ['60s length', 'Engaging hooks', 'Color grading', 'Dynamic transitions']
                },
                'cinematic-trailer': {
                    description: 'Creates an epic, dramatic cinematic trailer from footage.',
                    features: ['Epic', 'Dramatic', 'Color grading', 'Dynamic transitions']
                },
                'documentary': {
                    description: 'Edits footage into a narrative, educational documentary.',
                    features: ['Narrative', 'Educational', 'Color grading', 'Dynamic transitions']
                },
                'short-film': {
                    description: 'Edits footage into an artistic, storytelling short film.',
                    features: ['Artistic', 'Storytelling', 'Color grading', 'Dynamic transitions']
                },
                'corporate-presentation': {
                    description: 'Edits footage into a clean, professional corporate presentation.',
                    features: ['Clean', 'Professional', 'Color grading', 'Dynamic transitions']
                },
                'product-demo': {
                    description: 'Edits footage into a clear, informative product demonstration.',
                    features: ['Clear', 'Informative', 'Color grading', 'Dynamic transitions']
                },
                'marketing-ad': {
                    description: 'Edits footage into an engaging, conversion-focused marketing ad.',
                    features: ['Engaging', 'Conversion-focused', 'Color grading', 'Dynamic transitions']
                },
                'tutorial': {
                    description: 'Edits footage into a step-by-step, clear tutorial.',
                    features: ['Step-by-step', 'Clear', 'Color grading', 'Dynamic transitions']
                },
                'educational-content': {
                    description: 'Edits footage into an engaging, informative educational content.',
                    features: ['Engaging', 'Informative', 'Color grading', 'Dynamic transitions']
                },
                'how-to-guide': {
                    description: 'Edits footage into a practical, actionable how-to guide.',
                    features: ['Practical', 'Actionable', 'Color grading', 'Dynamic transitions']
                },
                'wedding-video': {
                    description: 'Edits footage into a romantic, emotional wedding video.',
                    features: ['Romantic', 'Emotional', 'Color grading', 'Dynamic transitions']
                },
                'travel-vlog': {
                    description: 'Edits footage into an adventure, beautiful location travel vlog.',
                    features: ['Adventure', 'Beautiful locations', 'Color grading', 'Dynamic transitions']
                },
                'event-coverage': {
                    description: 'Edits footage into a party, celebration event coverage.',
                    features: ['Parties', 'Celebrations', 'Color grading', 'Dynamic transitions']
                },
                'comedy-sketch': {
                    description: 'Edits footage into a timing, punchline comedy sketch.',
                    features: ['Timing', 'Punchlines', 'Color grading', 'Dynamic transitions']
                },
                'meme-compilation': {
                    description: 'Edits footage into a trending, viral meme compilation.',
                    features: ['Trending', 'Viral', 'Color grading', 'Dynamic transitions']
                },
                'reaction-video': {
                    description: 'Edits footage into an emotional, engaging reaction video.',
                    features: ['Emotional', 'Engaging', 'Color grading', 'Dynamic transitions']
                }
            };

            return styles[style] || { description: 'No description available for this style.', features: [] };
        }

        // Get AI insights based on style
        function getAIInsights(style) {
            const insights = {
                'gaming-montage': [
                    'The AI will analyze your gaming footage to identify the most exciting moments and transitions.',
                    'It will create a fast-paced, glitchy, and energetic montage by combining key gameplay moments.',
                    'Expect dynamic cuts, color grading, and dynamic transitions to make the video feel more cinematic.',
                    'The AI will prioritize action-packed sequences and highlight the most impactful plays.'
                ],
                'gaming-highlights': [
                    'This style focuses on capturing the most thrilling and impactful moments from your gaming footage.',
                    'The AI will identify kill streaks, epic plays, and moments of high performance.',
                    'Expect dramatic slow-motion sequences and color grading to enhance the emotional impact.',
                    'It will prioritize the most memorable and replayable moments for your highlight reel.'
                ],
                'streamer-clips': [
                    'This style is perfect for editing funny, reaction, and fail moments from your stream.',
                    'The AI will focus on capturing the most entertaining and viral moments from your stream.',
                    'Expect dynamic cuts, color grading, and dynamic transitions to make the video feel more engaging.',
                    'It will prioritize the most hilarious and shareable moments for your stream clips.'
                ],
                'sports-mixtape': [
                    'This style combines multiple sports moments into a cohesive, highlight-packed video.',
                    'The AI will analyze your sports footage to identify dunks, goals, and athletic feats.',
                    'Expect dramatic slow-motion sequences and color grading to make the video feel more exciting.',
                    'It will prioritize the most impressive and memorable moments for your sports mixtape.'
                ],
                'action-sports': [
                    'Edits action sports footage (skateboarding, surfing, extreme sports) for a thrilling experience.',
                    'The AI will focus on creating dynamic cuts, color grading, and dynamic transitions.',
                    'Expect slow-motion sequences and dramatic music to make the video feel more adrenaline-pumping.',
                    'It will prioritize the most impressive and replayable moments for your action sports edit.'
                ],
                'fitness-motivation': [
                    'Edits workout footage to create motivational and inspiring content.',
                    'The AI will analyze your workout footage to identify the most impactful moments.',
                    'Expect dramatic slow-motion sequences and color grading to make the video feel more inspiring.',
                    'It will prioritize the most motivating and transformational moments for your fitness content.'
                ],
                'music-video': [
                    'Creates a cinematic music video with beat-synced cuts and dynamic transitions.',
                    'The AI will analyze your audio to detect beats and rhythm.',
                    'Expect beat-synced cuts and dynamic transitions to make the video feel more cinematic.',
                    'It will prioritize the most engaging and memorable music moments for your music video.'
                ],
                'dance-performance': [
                    'Edits dance performance footage for a rhythm-based, energetic video.',
                    'The AI will analyze your dance footage to identify the rhythm and energy.',
                    'Expect rhythm-based cuts and dynamic transitions to make the video feel more energetic.',
                    'It will prioritize the most energetic and engaging dance moments for your performance.'
                ],
                'live-concert': [
                    'Edits live concert footage to capture the energy and excitement of the audience.',
                    'The AI will analyze the crowd energy and stage presence.',
                    'Expect dynamic cuts, color grading, and dynamic transitions to make the video feel more exciting.',
                    'It will prioritize the most energetic and memorable moments for your concert edit.'
                ],
                'tiktok-reels': [
                    'Creates a TikTok/Reels style video with 9:16 format and trending effects.',
                    'The AI will convert your footage to 9:16 vertical format and add trending effects.',
                    'Expect 9:16 format, trending effects, and dynamic transitions for a viral TikTok/Reels.',
                    'It will prioritize the most engaging and viral potential for your TikTok/Reels.'
                ],
                'instagram-story': [
                    'Edits footage for Instagram Story with 15s vertical format and engaging hooks.',
                    'The AI will convert your footage to 15s vertical format and add engaging hooks.',
                    'Expect 15s vertical format, engaging hooks, and dynamic transitions for an Instagram Story.',
                    'It will prioritize the most engaging and viral potential for your Instagram Story.'
                ],
                'youtube-shorts': [
                    'Edits footage for YouTube Shorts with 60s length and engaging hooks.',
                    'The AI will convert your footage to 60s length and add engaging hooks.',
                    'Expect 60s length, engaging hooks, and dynamic transitions for a YouTube Shorts.',
                    'It will prioritize the most engaging and viral potential for your YouTube Shorts.'
                ],
                'cinematic-trailer': [
                    'Creates an epic, dramatic cinematic trailer from footage.',
                    'The AI will analyze your footage for dramatic moments and narrative structure.',
                    'Expect epic text overlays, dramatic music, and dynamic transitions for a cinematic trailer.',
                    'It will prioritize the most impactful and cinematic moments for your trailer.'
                ],
                'documentary': [
                    'Edits footage into a narrative, educational documentary.',
                    'The AI will analyze your footage for key moments and narrative structure.',
                    'Expect professional graphics, charts, and dynamic transitions for an educational documentary.',
                    'It will prioritize the most informative and engaging moments for your documentary.'
                ],
                'short-film': [
                    'Edits footage into an artistic, storytelling short film.',
                    'The AI will analyze your footage for artistic elements and storytelling structure.',
                    'Expect artistic cuts, color grading, and dynamic transitions for an artistic short film.',
                    'It will prioritize the most artistic and impactful moments for your short film.'
                ],
                'corporate-presentation': [
                    'Edits footage into a clean, professional corporate presentation.',
                    'The AI will analyze your content for key messages and professional graphics.',
                    'Expect professional graphics, charts, and dynamic transitions for a corporate presentation.',
                    'It will prioritize the most professional and impactful moments for your presentation.'
                ],
                'product-demo': [
                    'Edits footage into a clear, informative product demonstration.',
                    'The AI will analyze your footage for key features and benefits.',
                    'Expect clear, informative cuts, color grading, and dynamic transitions for a product demo.',
                    'It will prioritize the most informative and engaging moments for your product demo.'
                ],
                'marketing-ad': [
                    'Edits footage into an engaging, conversion-focused marketing ad.',
                    'The AI will analyze your footage for conversion-focused elements and engaging hooks.',
                    'Expect engaging hooks, conversion-focused cuts, and dynamic transitions for a marketing ad.',
                    'It will prioritize the most engaging and conversion-focused moments for your marketing ad.'
                ],
                'tutorial': [
                    'Edits footage into a step-by-step, clear tutorial.',
                    'The AI will analyze your footage for logical steps and key learning points.',
                    'Expect step-by-step cuts, chapter markers, and dynamic transitions for a tutorial.',
                    'It will prioritize the most clear and engaging moments for your tutorial.'
                ],
                'educational-content': [
                    'Edits footage into an engaging, informative educational content.',
                    'The AI will analyze your footage for engaging and informative elements.',
                    'Expect engaging cuts, color grading, and dynamic transitions for an educational content.',
                    'It will prioritize the most engaging and informative moments for your educational content.'
                ],
                'how-to-guide': [
                    'Edits footage into a practical, actionable how-to guide.',
                    'The AI will analyze your footage for practical and actionable steps.',
                    'Expect practical cuts, color grading, and dynamic transitions for a how-to guide.',
                    'It will prioritize the most practical and actionable moments for your how-to guide.'
                ],
                'wedding-video': [
                    'Edits footage into a romantic, emotional wedding video.',
                    'The AI will analyze your footage for emotional moments and special moments.',
                    'Expect romantic filters, slow-motion, and dynamic transitions for a romantic wedding video.',
                    'It will prioritize the most romantic and emotional moments for your wedding video.'
                ],
                'travel-vlog': [
                    'Edits footage into an adventure, beautiful location travel vlog.',
                    'The AI will analyze your footage for beautiful landscapes and locations.',
                    'Expect travel-inspired color grading, location text overlays, and dynamic transitions for a travel vlog.',
                    'It will prioritize the most beautiful and engaging moments for your travel vlog.'
                ],
                'event-coverage': [
                    'Edits footage into a party, celebration event coverage.',
                    'The AI will analyze your footage for party and celebration moments.',
                    'Expect party filters, celebration effects, and dynamic transitions for an event coverage.',
                    'It will prioritize the most festive and memorable moments for your event coverage.'
                ],
                'comedy-sketch': [
                    'Edits footage into a timing, punchline comedy sketch.',
                    'The AI will analyze your footage for funny moments and punchlines.',
                    'Expect comedic effects, zooms, and dynamic transitions for a comedy sketch.',
                    'It will prioritize the most humorous and engaging moments for your comedy sketch.'
                ],
                'meme-compilation': [
                    'Edits footage into a trending, viral meme compilation.',
                    'The AI will analyze your footage for trending and viral moments.',
                    'Expect trending effects, viral filters, and dynamic transitions for a meme compilation.',
                    'It will prioritize the most viral and shareable moments for your meme compilation.'
                ],
                'reaction-video': [
                    'Edits footage into an emotional, engaging reaction video.',
                    'The AI will analyze your footage for emotional and engaging moments.',
                    'Expect emotional cuts, dynamic transitions, and color grading for a reaction video.',
                    'It will prioritize the most emotional and engaging moments for your reaction video.'
                ]
            };

            return insights[style] || ['No specific insights available for this style.'];
        }

        // Upload video and create project
        async function uploadVideo() {
            const videoFiles = document.getElementById('videoInput').files;
            const projectName = document.getElementById('projectName').value;
            const style = document.getElementById('styleSelect').value;
            const intensity = document.getElementById('intensitySelect').value;
            const quality = document.getElementById('qualitySelect').value;
            const musicFile = document.getElementById('musicUpload').files[0];
            const customEffects = Array.from(document.getElementById('customEffects').selectedOptions).map(opt => opt.value);
            const platformOptimize = document.getElementById('platformOptimize').value;
            const aiIntelligence = document.getElementById('aiIntelligence').value;
            const aiInstructions = document.getElementById('aiInstructions').value;

            if (videoFiles.length === 0) {
                alert('Please select at least one video file!');
                return;
            }

            if (!projectName) {
                alert('Please enter a project name!');
                return;
            }

            if (!style) {
                alert('Please select an editing style!');
                return;
            }

            const formData = new FormData();
            for (let i = 0; i < videoFiles.length; i++) {
                formData.append('videos', videoFiles[i]);
            }
            formData.append('projectName', projectName);
            formData.append('style', style);
            formData.append('intensity', intensity);
            formData.append('quality', quality);
            
            // Add advanced options
            if (musicFile) {
                formData.append('music', musicFile);
            }
            if (customEffects.length > 0) {
                formData.append('customEffects', JSON.stringify(customEffects));
            }
            formData.append('platformOptimize', platformOptimize);
            formData.append('aiIntelligence', aiIntelligence);
            formData.append('aiInstructions', aiInstructions);

            const uploadBtn = document.getElementById('uploadBtn');
            uploadBtn.disabled = true;
            uploadBtn.textContent = '‚è≥ Uploading...';

            try {
                const headers = {};
                if (isAuthenticated()) {
                    headers['Authorization'] = `Bearer ${getAuthToken()}`;
                }

                const response = await fetch(`${API_BASE}/upload`, {
                    method: 'POST',
                    headers,
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    alert('üéâ Video uploaded successfully! AI processing has started.');
                } else {
                    const errorData = await response.json();
                    
                    if (errorData.requiresAccount) {
                        // Guest has exceeded free trial limit
                        if (confirm('You have used all your free video edits. Would you like to create an account and choose a subscription plan?')) {
                            window.location.href = '/plans';
                        }
                    } else if (errorData.requiresSubscription) {
                        // User needs to choose a subscription plan
                        if (confirm('You need to choose a subscription plan to continue. Would you like to view available plans?')) {
                            window.location.href = '/plans';
                        }
                    } else {
                        alert(`‚ùå Upload failed: ${errorData.error || 'Unknown error'}`);
                    }
                    return;
                }
                    
                    // Reset form
                    document.getElementById('uploadForm').reset();
                    document.getElementById('customEffects').selectedIndex = -1;
                    document.getElementById('platformOptimize').value = 'auto';
                    document.getElementById('aiIntelligence').value = 'smart';
                    document.getElementById('aiInstructions').value = ''; // Clear AI instructions
                    
                    // Reset upload areas
                    document.querySelector('.upload-area').innerHTML = `
                        <div class="upload-icon">üìÅ</div>
                        <h3>Upload Your Videos</h3>
                        <p>Click here to select multiple video files or drag and drop</p>
                        <p class="upload-hint">üé¨ You can upload multiple videos to combine them into one!</p>
                        <input type="file" id="videoInput" accept="video/*" multiple style="display: none;" onchange="handleVideoSelect(event)">
                    `;
                    document.querySelector('.upload-area').onclick = () => document.getElementById('videoInput').click();
                    
                    // Reset music upload
                    const musicUploadGroup = document.getElementById('musicUpload').parentElement;
                    musicUploadGroup.innerHTML = `
                        <label for="musicUpload">ÔøΩÔøΩ Background Music (Optional)</label>
                        <input type="file" id="musicUpload" accept="audio/*" onchange="handleMusicSelect(event)">
                        <small>AI will sync video cuts with music beats</small>
                    `;
                    
                    // Clear style details
                    document.getElementById('styleSelect').value = '';
                    document.getElementById('styleDetails').style.display = 'none';
                    
                    // Reload projects and start monitoring
                    loadProjects();
                    
                    // Start progress monitoring for the new project
                    if (result.projectId) {
                        setTimeout(() => {
                            monitorProgress(result.projectId);
                        }, 1000);
                    }
            } catch (error) {
                console.error('Upload error:', error);
                alert(`‚ùå Upload failed: ${error.message}`);
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'üöÄ Start AI Processing';
            }
        }

        // Start AI processing for a project
        async function startProcessing(projectId) {
            try {
                // Find the project
                const project = projects.find(p => p.id === projectId);
                if (!project) {
                    throw new Error('Project not found');
                }

                // Call the real AI processing API
                const response = await fetch(`${API_BASE}/projects/${projectId}/process`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    
                    // Update project status
                    project.status = 'processing';
                    project.progress = 0;
                    project.currentStep = 'Starting AI analysis...';
                    
                    // Refresh the display
                    renderProjects();
                    
                    // Start progress monitoring
                    monitorProgress(projectId);
                    
                    alert('üöÄ Real AI processing started! This will analyze your video and apply intelligent editing.');
                    
                } else {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to start processing');
                }
                
            } catch (error) {
                console.error('Processing error:', error);
                alert(`‚ùå Failed to start processing: ${error.message}`);
            }
        }

        // Monitor project progress with real AI processing
        function monitorProgress(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) return;
            
            const interval = setInterval(async () => {
                try {
                    // Get real-time progress from server
                    const response = await fetch(`${API_BASE}/projects/${projectId}`);
                    if (response.ok) {
                        const updatedProject = await response.json();
                        
                        // Update local project data
                        project.status = updatedProject.status;
                        project.progress = updatedProject.progress || 0;
                        project.currentStep = updatedProject.currentStep || '';
                        
                        // Refresh display
                        renderProjects();
                        
                        // Stop monitoring if processing is complete
                        if (project.status === 'completed' || project.status === 'error') {
                            clearInterval(interval);
                            
                            if (project.status === 'completed') {
                                alert('üéâ Your AI video is ready! The AI has analyzed your content and applied intelligent editing.');
                            } else {
                                alert(`‚ùå AI processing failed: ${project.error || 'Unknown error'}`);
                            }
                        }
                    }
                } catch (error) {
                    console.error('Progress monitoring error:', error);
                    // Continue monitoring even if there's an error
                }
            }, 2000); // Check every 2 seconds
        }

        // Get processing steps based on style
        function getProcessingSteps(style) {
            const styleSteps = {
                'gaming-montage': [
                    'üéÆ Analyzing gameplay footage for epic moments...',
                    '‚ö° Detecting kills, combos, and highlight plays...',
                    'üéµ Syncing cuts with music beats...',
                    '‚ú® Applying glitch effects and neon overlays...',
                    'üé¨ Finalizing with dynamic transitions...'
                ],
                'gaming-highlights': [
                    'üî• Scanning for kill streaks and epic plays...',
                    'üéØ Identifying peak performance moments...',
                    '‚ö° Adding slow-motion to key highlights...',
                    'üé® Applying dramatic color grading...',
                    'üöÄ Finalizing highlight compilation...'
                ],
                'sports-mixtape': [
                    'üèÄ Detecting dunks, goals, and athletic feats...',
                    'üìä Adding stat overlays and player info...',
                    '‚ö° Creating dramatic slow-motion sequences...',
                    'üéµ Syncing with hype music...',
                    'üèÜ Finalizing championship-worthy edit...'
                ],
                'music-video': [
                    'üéµ Analyzing audio for beat detection...',
                    'üé¨ Syncing video cuts with music rhythm...',
                    'üé® Applying cinematic color grading...',
                    '‚ú® Adding visual effects and transitions...',
                    'üé≠ Finalizing music video masterpiece...'
                ],
                'tiktok-reels': [
                    'üì± Converting to 9:16 vertical format...',
                    '‚ö° Creating engaging hook in first 3 seconds...',
                    'üé® Adding trending effects and transitions...',
                    'üìù Generating auto-captions...',
                    'üöÄ Optimizing for viral potential...'
                ],
                'cinematic-trailer': [
                    'üé≠ Analyzing footage for dramatic moments...',
                    'üìñ Structuring into 3-act narrative...',
                    'üé¨ Adding epic text overlays...',
                    'üéµ Syncing with dramatic music...',
                    'üé™ Finalizing cinematic masterpiece...'
                ],
                'corporate-presentation': [
                    'üíº Analyzing content for key messages...',
                    'üìä Adding professional graphics and charts...',
                    'üé® Applying brand colors and styling...',
                    'üìù Generating professional titles...',
                    '‚úÖ Finalizing corporate presentation...'
                ],
                'tutorial': [
                    'üìö Breaking down content into logical steps...',
                    'üìù Adding chapter markers and captions...',
                    'üéØ Highlighting key learning points...',
                    '‚è±Ô∏è Adjusting pacing for clarity...',
                    'üéì Finalizing educational tutorial...'
                ],
                'travel-vlog': [
                    '‚úàÔ∏è Detecting beautiful landscapes and locations...',
                    'üé® Applying travel-inspired color grading...',
                    'üåç Adding location text overlays...',
                    'üéµ Syncing with upbeat travel music...',
                    'üåÖ Finalizing adventure vlog...'
                ],
                'wedding-video': [
                    'üíí Detecting emotional moments and smiles...',
                    'üíï Adding romantic filters and effects...',
                    '‚ú® Creating slow-motion for special moments...',
                    'üéµ Syncing with vows and romantic music...',
                    'üíç Finalizing romantic wedding video...'
                ],
                'comedy-sketch': [
                    'üòÇ Detecting punchlines and funny moments...',
                    'üé≠ Adding comedic effects and zooms...',
                    '‚è∞ Timing cuts for maximum humor...',
                    'üéµ Adding meme sound effects...',
                    'üé™ Finalizing comedy masterpiece...'
                ]
            };
            
            // Default steps for any style
            const defaultSteps = [
                'üîç Analyzing video content and structure...',
                'üéØ Detecting key moments and highlights...',
                'üé® Applying style-specific effects...',
                '‚ö° Optimizing pacing and transitions...',
                'üé¨ Finalizing professional edit...'
            ];
            
            return styleSteps[style] || defaultSteps;
        }

        // Preview processed video
        function previewVideo(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) return;
            
            // Create modal for video preview
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="position: relative; max-width: 90%; max-height: 90%;">
                    <button onclick="this.parentElement.parentElement.remove()" 
                            style="position: absolute; top: -40px; right: 0; background: #ff6b6b; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer;">
                        ‚úï Close
                    </button>
                    <video controls style="max-width: 100%; max-height: 100%;">
                        <source src="${API_BASE}/projects/${projectId}/video" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal on background click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // Retry AI processing for a failed project
        async function retryProcessing(projectId) {
            try {
                const project = projects.find(p => p.id === projectId);
                if (!project) {
                    throw new Error('Project not found');
                }

                // Reset project status
                project.status = 'uploaded';
                project.progress = 0;
                project.currentStep = '';
                project.error = null;
                
                // Refresh display
                renderProjects();
                
                // Start processing again
                startProcessing(projectId);
                
            } catch (error) {
                console.error('Retry error:', error);
                alert(`‚ùå Failed to retry processing: ${error.message}`);
            }
        }

        // Download processed video
        async function downloadVideo(projectId) {
            try {
                const project = projects.find(p => p.id === projectId);
                if (!project) {
                    throw new Error('Project not found');
                }

                if (project.status !== 'completed') {
                    alert('‚ùå Video is not ready for download yet. Please wait for AI processing to complete.');
                    return;
                }

                // Create download link for the processed video
                const downloadUrl = `${API_BASE}/projects/${projectId}/download`;
                
                // Create temporary link element
                const link = document.createElement('a');
                link.href = downloadUrl;
                link.download = `AI-Edited-${project.name || 'Video'}.mp4`;
                link.style.display = 'none';
                
                // Add to page and click
                document.body.appendChild(link);
                link.click();
                
                // Clean up
                document.body.removeChild(link);
                
                alert('üé¨ Download started! Your AI-edited video is being downloaded.');
                
            } catch (error) {
                console.error('Download error:', error);
                alert(`‚ùå Download failed: ${error.message}`);
            }
        }

        // Delete project
        async function deleteProject(projectId) {
            if (!confirm('Are you sure you want to delete this project? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/projects/${projectId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`
                    }
                });

                if (response.ok) {
                    loadProjects(); // Refresh projects list
                    alert('üóëÔ∏è Project deleted successfully');
                } else {
                    const error = await response.json();
                    throw new Error(error.error || 'Delete failed');
                }
            } catch (error) {
                console.error('Delete error:', error);
                alert(`‚ùå Delete failed: ${error.message}`);
            }
        }

        // Authentication and User Management
        function getAuthToken() {
            return localStorage.getItem('authToken');
        }

        function getUser() {
            const userStr = localStorage.getItem('user');
            return userStr ? JSON.parse(userStr) : null;
        }

        function isAuthenticated() {
            return !!getAuthToken();
        }

        function checkAuth() {
            if (!isAuthenticated()) {
                window.location.href = '/login.html';
                return false;
            }
            return true;
        }

        function updateUserInterface() {
            const user = getUser();
            if (user) {
                document.getElementById('username').textContent = user.username;
                // Load subscription info for authenticated users
                loadSubscriptionInfo();
            } else {
                // Load guest usage info for non-authenticated users
                loadGuestUsageInfo();
            }
        }

        // Load subscription information
        async function loadSubscriptionInfo() {
            try {
                const response = await fetch(`${API_BASE}/subscriptions/current`, {
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.hasSubscription) {
                        displaySubscriptionInfo(data.subscription);
                    } else {
                        // No subscription - show plans link
                        document.getElementById('subscriptionLink').textContent = 'Get Subscription';
                    }
                }
            } catch (error) {
                console.error('Error loading subscription:', error);
            }
        }

        // Display subscription information
        function displaySubscriptionInfo(subscription) {
            const subscriptionInfo = document.getElementById('subscriptionInfo');
            const planName = document.getElementById('planName');
            const videoCount = document.getElementById('videoCount');
            const subscriptionLink = document.getElementById('subscriptionLink');

            planName.textContent = subscription.planName;
            videoCount.textContent = `${subscription.currentVideoCount}/${subscription.maxVideos} videos`;
            subscriptionLink.textContent = 'Manage Subscription';

            subscriptionInfo.style.display = 'block';
        }

        // Load guest usage information
        async function loadGuestUsageInfo() {
            try {
                const response = await fetch(`${API_BASE}/guest/usage`);
                if (response.ok) {
                    const data = await response.json();
                    displayGuestUsageInfo(data);
                }
            } catch (error) {
                console.error('Error loading guest usage:', error);
            }
        }

        // Display guest usage information
        function displayGuestUsageInfo(usage) {
            const guestBanner = document.getElementById('guestBanner');
            const remainingVideos = document.getElementById('remainingVideos');
            const username = document.getElementById('username');

            if (usage.blocked || usage.remaining === 0) {
                // Guest has used all free edits
                username.textContent = 'Guest (Limit Reached)';
                guestBanner.style.display = 'block';
                remainingVideos.textContent = '0';
                
                // Update banner message
                const bannerText = guestBanner.querySelector('.banner-text p');
                bannerText.innerHTML = 'You have used all your free video edits. <a href="/plans" class="banner-link">Create an account and choose a plan</a> to continue.';
            } else if (usage.usageCount > 0) {
                // Guest has some remaining edits
                username.textContent = `Guest (${usage.remaining} remaining)`;
                guestBanner.style.display = 'block';
                remainingVideos.textContent = usage.remaining;
            } else {
                // First time guest
                username.textContent = 'Guest (1 free edit)';
                guestBanner.style.display = 'block';
                remainingVideos.textContent = '1';
            }
        }

        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('active');
        }

        function logout() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('user');
            window.location.href = '/login.html';
        }

        // Close user menu when clicking outside
        document.addEventListener('click', (e) => {
            const userMenu = document.querySelector('.user-menu');
            if (!userMenu.contains(e.target)) {
                document.getElementById('userDropdown').classList.remove('active');
            }
        });

        // Initialize authentication
        window.addEventListener('load', () => {
            updateUserInterface();
            loadProjects();
        });
    </script>
</body>
</html>
 